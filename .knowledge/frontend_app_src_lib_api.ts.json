{"is_source_file": true, "format": "TypeScript", "description": "This file contains API utility functions for the Recipe Explorer application, including functions to fetch recipes and recipe details, handle HTTP requests securely, compose query strings, and provide mock data fallbacks when API endpoints are unavailable. It also manages environment configurations and cache behaviors suitable for development and production environments.", "external_files": ["./types"], "external_methods": ["fetch"], "published": ["getRecipes", "getRecipeById"], "classes": [], "methods": [{"name": "function toQueryString(params: Record<string, unknown> = {}): string { toQueryString", "description": "Converts a parameters object into a URL query string, skipping undefined or null values and trimming strings.", "scope": "", "scopeKind": ""}, {"name": "async function safeFetchJson<T>(url: string, init?: RequestInit): Promise<ApiResult<T>> { safeFetchJson", "description": "Performs a fetch request with built-in error handling, content type checking, and response normalization.", "scope": "", "scopeKind": ""}, {"name": "function queryMockRecipes(params: RecipeQueryParams = {}): PaginatedResult<Recipe> { queryMockRecipes", "description": "Filters, sorts, and paginates the MOCK_RECIPES dataset based on provided query parameters.", "scope": "", "scopeKind": ""}, {"name": "function buildUrl(path: string, params?: Record<string, unknown>): string | null { buildUrl", "description": "Constructs a full URL for API requests based on the base environment variable and given path and parameters.", "scope": "", "scopeKind": ""}, {"name": "export async function getRecipes( getRecipes", "description": "Loads a paginated list of recipes from the API, falling back to mock data if API call fails or base URL is not set.", "scope": "", "scopeKind": ""}, {"name": "export async function getRecipeById( getRecipeById", "description": "Retrieves a single recipe by ID from the API, with fallback to mock data if needed.", "scope": "", "scopeKind": ""}], "calls": ["fetch", "toQueryString", "safeFetchJson", "queryMockRecipes", "buildUrl"], "search-terms": ["api.ts", "RecipeExplorer", "fetch", "mock dataset", "getRecipes", "getRecipeById", "API utilities", "environment", "fallback"], "state": 2, "file_id": 9, "knowledge_revision": 19, "git_revision": "", "ctags": [{"_type": "tag", "name": "Date", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^        const ad = a.datePublished ? Date.parse(a.datePublished) : 0;$/", "language": "TypeScript", "kind": "constant", "scope": "queryMockRecipes", "scopeKind": "function"}, {"_type": "tag", "name": "Date", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^        const bd = b.datePublished ? Date.parse(b.datePublished) : 0;$/", "language": "TypeScript", "kind": "constant", "scope": "queryMockRecipes", "scopeKind": "function"}, {"_type": "tag", "name": "ENV", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^const ENV = import.meta.env || {};$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "IS_DEV", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^const IS_DEV = !!(ENV?.PUBLIC_NODE_ENV$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "MOCK_RECIPES", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^const MOCK_RECIPES: Recipe[] = [$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "PUBLIC_API_BASE", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^const PUBLIC_API_BASE: string | undefined = ENV.PUBLIC_API_BASE || ENV.PUBLIC_BACKEND_URL;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "ad", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^        const ad = a.datePublished ? Date.parse(a.datePublished) : 0;$/", "language": "TypeScript", "kind": "constant", "scope": "queryMockRecipes", "scopeKind": "function"}, {"_type": "tag", "name": "base", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^  const base = (PUBLIC_API_BASE || '').trim();$/", "language": "TypeScript", "kind": "constant", "scope": "buildUrl", "scopeKind": "function"}, {"_type": "tag", "name": "bd", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^        const bd = b.datePublished ? Date.parse(b.datePublished) : 0;$/", "language": "TypeScript", "kind": "constant", "scope": "queryMockRecipes", "scopeKind": "function"}, {"_type": "tag", "name": "body", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^          const body = await res.json();$/", "language": "TypeScript", "kind": "constant", "scope": "safeFetchJson", "scopeKind": "function"}, {"_type": "tag", "name": "buildUrl", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^function buildUrl(path: string, params?: Record<string, unknown>): string | null {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "contentType", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^    const contentType = res.headers.get('content-type') || '';$/", "language": "TypeScript", "kind": "constant", "scope": "safeFetchJson", "scopeKind": "function"}, {"_type": "tag", "name": "course", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^    course,$/", "language": "TypeScript", "kind": "constant", "scope": "queryMockRecipes", "scopeKind": "function"}, {"_type": "tag", "name": "cuisine", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^    cuisine,$/", "language": "TypeScript", "kind": "constant", "scope": "queryMockRecipes", "scopeKind": "function"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^      const data = await res.json();$/", "language": "TypeScript", "kind": "constant", "scope": "safeFetchJson", "scopeKind": "function"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^  const data = queryMockRecipes(params);$/", "language": "TypeScript", "kind": "constant", "scope": "getRecipes", "scopeKind": "function"}, {"_type": "tag", "name": "difficulty", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^    difficulty,$/", "language": "TypeScript", "kind": "constant", "scope": "queryMockRecipes", "scopeKind": "function"}, {"_type": "tag", "name": "dir", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^    const dir = sortDir === 'desc' ? -1 : 1;$/", "language": "TypeScript", "kind": "constant", "scope": "queryMockRecipes", "scopeKind": "function"}, {"_type": "tag", "name": "found", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^  const found = MOCK_RECIPES.find((r) => r.id === id);$/", "language": "TypeScript", "kind": "constant", "scope": "getRecipeById", "scopeKind": "function"}, {"_type": "tag", "name": "getRecipeById", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^export async function getRecipeById($/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "getRecipes", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^export async function getRecipes($/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "hasMore", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^  const hasMore = start + pageSize < total;$/", "language": "TypeScript", "kind": "constant", "scope": "queryMockRecipes", "scopeKind": "function"}, {"_type": "tag", "name": "hay", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^      const hay = `${r.title} ${r.description ?? ''} ${r.ingredients.map(i => i.text).join(' ')}/", "language": "TypeScript", "kind": "constant", "scope": "queryMockRecipes", "scopeKind": "function"}, {"_type": "tag", "name": "isJson", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^    const isJson = contentType.includes('application\\/json');$/", "language": "TypeScript", "kind": "constant", "scope": "safeFetchJson", "scopeKind": "function"}, {"_type": "tag", "name": "message", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^    const message = e?.message || 'Network error';$/", "language": "TypeScript", "kind": "constant", "scope": "safeFetchJson", "scopeKind": "function"}, {"_type": "tag", "name": "minRating", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^    minRating,$/", "language": "TypeScript", "kind": "constant", "scope": "queryMockRecipes", "scopeKind": "function"}, {"_type": "tag", "name": "needle", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^    const needle = q.trim().toLowerCase();$/", "language": "TypeScript", "kind": "constant", "scope": "queryMockRecipes", "scopeKind": "function"}, {"_type": "tag", "name": "normalized", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^    const normalized = base.endsWith('\\/') ? base.slice(0, -1) : base;$/", "language": "TypeScript", "kind": "constant", "scope": "buildUrl", "scopeKind": "function"}, {"_type": "tag", "name": "p", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^    const p = path.startsWith('\\/') ? path : `\\/${path}`;$/", "language": "TypeScript", "kind": "constant", "scope": "buildUrl", "scopeKind": "function"}, {"_type": "tag", "name": "page", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^    page = 1,$/", "language": "TypeScript", "kind": "constant", "scope": "queryMockRecipes", "scopeKind": "function"}, {"_type": "tag", "name": "paged", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^  const paged = items.slice(start, start + pageSize);$/", "language": "TypeScript", "kind": "constant", "scope": "queryMockRecipes", "scopeKind": "function"}, {"_type": "tag", "name": "q", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^    q,$/", "language": "TypeScript", "kind": "constant", "scope": "queryMockRecipes", "scopeKind": "function"}, {"_type": "tag", "name": "qs", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^  const qs = usp.toString();$/", "language": "TypeScript", "kind": "constant", "scope": "toQueryString", "scopeKind": "function"}, {"_type": "tag", "name": "queryMockRecipes", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^function queryMockRecipes(params: RecipeQueryParams = {}): PaginatedResult<Recipe> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "res", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^    const res = await fetch(url, {$/", "language": "TypeScript", "kind": "constant", "scope": "safeFetchJson", "scopeKind": "function"}, {"_type": "tag", "name": "result", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^    const result = await safeFetchJson<PaginatedResult<Recipe>>(url);$/", "language": "TypeScript", "kind": "constant", "scope": "getRecipes", "scopeKind": "function"}, {"_type": "tag", "name": "result", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^    const result = await safeFetchJson<Recipe>(url);$/", "language": "TypeScript", "kind": "constant", "scope": "getRecipeById", "scopeKind": "function"}, {"_type": "tag", "name": "safeFetchJson", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^async function safeFetchJson<T>(url: string, init?: RequestInit): Promise<ApiResult<T>> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "start", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^  const start = Math.max(0, (page - 1) * pageSize);$/", "language": "TypeScript", "kind": "constant", "scope": "queryMockRecipes", "scopeKind": "function"}, {"_type": "tag", "name": "tag", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^    tag,$/", "language": "TypeScript", "kind": "constant", "scope": "queryMockRecipes", "scopeKind": "function"}, {"_type": "tag", "name": "text", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^          const text = await res.text();$/", "language": "TypeScript", "kind": "constant", "scope": "safeFetchJson", "scopeKind": "function"}, {"_type": "tag", "name": "toQueryString", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^function toQueryString(params: Record<string, unknown> = {}): string {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "total", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^  const total = items.length;$/", "language": "TypeScript", "kind": "constant", "scope": "queryMockRecipes", "scopeKind": "function"}, {"_type": "tag", "name": "url", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^  const url = buildUrl('\\/recipes', params);$/", "language": "TypeScript", "kind": "constant", "scope": "getRecipes", "scopeKind": "function"}, {"_type": "tag", "name": "url", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^  const url = buildUrl(`\\/recipes\\/${encodeURIComponent(id)}`);$/", "language": "TypeScript", "kind": "constant", "scope": "getRecipeById", "scopeKind": "function"}, {"_type": "tag", "name": "usp", "path": "/home/kavia/workspace/code-generation/recipe-explorer-209095-209117/frontend_app/src/lib/api.ts", "pattern": "/^  const usp = new URLSearchParams();$/", "language": "TypeScript", "kind": "constant", "scope": "toQueryString", "scopeKind": "function"}], "hash": "ac2c093ec8fc39bd79479ef9fdd085a6", "format-version": 4, "code-base-name": "frontend_app", "filename": "frontend_app/src/lib/api.ts", "revision_history": [{"19": ""}]}